<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Notifica√ß√µes - CFC Bom Conselho</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- CSS da Topbar -->
    <link href="assets/css/topbar-simple.css" rel="stylesheet">
    
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
        }
        
        .test-content {
            padding: 20px;
            margin-top: 64px;
        }
        
        .test-section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .test-section h2 {
            color: #2c3e50;
            margin-top: 0;
        }
        
        .test-button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        
        .test-button:hover {
            background: #2980b9;
        }
        
        .test-button.success {
            background: #2ecc71;
        }
        
        .test-button.warning {
            background: #f39c12;
        }
        
        .test-button.danger {
            background: #e74c3c;
        }
        
        .notification-demo {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid #3498db;
        }
        
        .notification-demo h4 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }
        
        .notification-demo p {
            margin: 5px 0;
            color: #666;
        }
        
        .status {
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
        }
        
        .status.warning {
            background: #fff3cd;
            color: #856404;
        }
    </style>
</head>
<body>
    <!-- Topbar ser√° criada pelo JavaScript -->
    
    <div class="test-content">
        <div class="test-section">
            <h2>üîî Teste Completo das Notifica√ß√µes</h2>
            <p>Esta p√°gina testa especificamente o sistema de notifica√ß√µes da topbar.</p>
            
            <div class="notification-demo">
                <h4>üìã Funcionalidades Testadas:</h4>
                <p>‚úÖ Badge de contagem de notifica√ß√µes n√£o lidas</p>
                <p>‚úÖ Dropdown com lista de notifica√ß√µes</p>
                <p>‚úÖ Indicadores visuais para notifica√ß√µes n√£o lidas</p>
                <p>‚úÖ Bot√£o "Marcar todas como lidas"</p>
                <p>‚úÖ Bot√£o "Ver todas"</p>
                <p>‚úÖ Clique em notifica√ß√£o individual</p>
            </div>
        </div>
        
        <div class="test-section">
            <h2>üß™ Testes Autom√°ticos</h2>
            <p>Execute os testes para verificar se as notifica√ß√µes est√£o funcionando:</p>
            
            <button class="test-button" onclick="testBadgeVisibility()">
                <i class="fas fa-eye"></i> Verificar Badge
            </button>
            
            <button class="test-button" onclick="testDropdownOpen()">
                <i class="fas fa-chevron-down"></i> Abrir Dropdown
            </button>
            
            <button class="test-button" onclick="testNotificationCount()">
                <i class="fas fa-list"></i> Contar Notifica√ß√µes
            </button>
            
            <button class="test-button success" onclick="testMarkAllRead()">
                <i class="fas fa-check-double"></i> Marcar Todas como Lidas
            </button>
            
            <button class="test-button warning" onclick="testAddNotification()">
                <i class="fas fa-plus"></i> Adicionar Notifica√ß√£o
            </button>
            
            <button class="test-button danger" onclick="testClearAll()">
                <i class="fas fa-trash"></i> Limpar Todas
            </button>
        </div>
        
        <div class="test-section">
            <h2>üìä Status das Notifica√ß√µes</h2>
            <div id="notification-status">
                <p>Carregando status...</p>
            </div>
        </div>
        
        <div class="test-section">
            <h2>üîç Log de Testes</h2>
            <div id="test-log" style="background: #f8f9fa; padding: 15px; border-radius: 8px; font-family: monospace; font-size: 12px; max-height: 300px; overflow-y: auto;">
                <p>Log de testes ser√° exibido aqui...</p>
            </div>
        </div>
    </div>
    
    <!-- JavaScript da Topbar -->
    <script src="assets/js/topbar-simple.js"></script>
    
    <script>
        let testLog = [];
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            testLog.push(logEntry);
            
            const logDiv = document.getElementById('test-log');
            logDiv.innerHTML = testLog.map(entry => `<p>${entry}</p>`).join('');
            logDiv.scrollTop = logDiv.scrollHeight;
            
            console.log(logEntry);
        }
        
        function updateStatus() {
            const statusDiv = document.getElementById('notification-status');
            const badge = document.getElementById('notification-badge');
            const dropdown = document.querySelector('.notification-dropdown');
            const items = document.querySelectorAll('.notification-item');
            const unreadItems = document.querySelectorAll('.notification-item.unread');
            
            let statusHtml = `
                <p><strong>Badge:</strong> 
                    ${badge && !badge.classList.contains('hidden') ? 
                        `<span class="status success">Vis√≠vel (${badge.textContent})</span>` : 
                        '<span class="status error">Oculto</span>'}
                </p>
                <p><strong>Dropdown:</strong> 
                    ${dropdown && dropdown.classList.contains('show') ? 
                        '<span class="status success">Aberto</span>' : 
                        '<span class="status warning">Fechado</span>'}
                </p>
                <p><strong>Total de Notifica√ß√µes:</strong> 
                    <span class="status ${items.length > 0 ? 'success' : 'error'}">${items.length}</span>
                </p>
                <p><strong>N√£o Lidas:</strong> 
                    <span class="status ${unreadItems.length > 0 ? 'warning' : 'success'}">${unreadItems.length}</span>
                </p>
            `;
            
            statusDiv.innerHTML = statusHtml;
        }
        
        function testBadgeVisibility() {
            log('üîç Testando visibilidade do badge...');
            const badge = document.getElementById('notification-badge');
            
            if (badge) {
                if (!badge.classList.contains('hidden')) {
                    log(`‚úÖ Badge vis√≠vel: ${badge.textContent}`, 'success');
                } else {
                    log('‚ö†Ô∏è Badge oculto', 'warning');
                }
            } else {
                log('‚ùå Badge n√£o encontrado', 'error');
            }
            
            updateStatus();
        }
        
        function testDropdownOpen() {
            log('üîç Testando abertura do dropdown...');
            const notificationIcon = document.querySelector('.notification-icon');
            
            if (notificationIcon) {
                notificationIcon.click();
                log('‚úÖ Clique no √≠cone de notifica√ß√µes executado', 'success');
                
                setTimeout(() => {
                    const dropdown = document.querySelector('.notification-dropdown');
                    if (dropdown && dropdown.classList.contains('show')) {
                        log('‚úÖ Dropdown aberto com sucesso', 'success');
                        
                        const items = dropdown.querySelectorAll('.notification-item');
                        log(`üì® ${items.length} notifica√ß√µes encontradas no dropdown`, 'info');
                    } else {
                        log('‚ùå Dropdown n√£o abriu', 'error');
                    }
                    
                    updateStatus();
                }, 100);
            } else {
                log('‚ùå √çcone de notifica√ß√µes n√£o encontrado', 'error');
            }
        }
        
        function testNotificationCount() {
            log('üîç Contando notifica√ß√µes...');
            const items = document.querySelectorAll('.notification-item');
            const unreadItems = document.querySelectorAll('.notification-item.unread');
            
            log(`üìä Total: ${items.length} | N√£o lidas: ${unreadItems.length}`, 'info');
            
            if (items.length > 0) {
                log('‚úÖ Notifica√ß√µes encontradas', 'success');
            } else {
                log('‚ö†Ô∏è Nenhuma notifica√ß√£o encontrada', 'warning');
            }
            
            updateStatus();
        }
        
        function testMarkAllRead() {
            log('üîç Testando marcar todas como lidas...');
            const button = document.getElementById('mark-all-read');
            
            if (button) {
                button.click();
                log('‚úÖ Bot√£o "Marcar todas como lidas" clicado', 'success');
                
                setTimeout(() => {
                    const badge = document.getElementById('notification-badge');
                    if (badge && badge.classList.contains('hidden')) {
                        log('‚úÖ Badge ocultado ap√≥s marcar todas como lidas', 'success');
                    } else {
                        log('‚ö†Ô∏è Badge ainda vis√≠vel', 'warning');
                    }
                    
                    updateStatus();
                }, 100);
            } else {
                log('‚ùå Bot√£o "Marcar todas como lidas" n√£o encontrado', 'error');
            }
        }
        
        function testAddNotification() {
            log('üîç Adicionando notifica√ß√£o de teste...');
            
            // Simular adi√ß√£o de notifica√ß√£o
            const mockNotification = {
                id: Date.now(),
                title: 'Notifica√ß√£o de Teste',
                message: 'Esta √© uma notifica√ß√£o adicionada via teste',
                type: 'info',
                url: '#',
                unread: true,
                created_at: new Date().toISOString(),
                icon: 'fas fa-info-circle',
                color: '#3498db'
            };
            
            // Recarregar notifica√ß√µes
            if (window.topbarInstance) {
                window.topbarInstance.loadMockNotifications();
                log('‚úÖ Notifica√ß√£o de teste adicionada', 'success');
            } else {
                log('‚ùå Inst√¢ncia da topbar n√£o encontrada', 'error');
            }
            
            updateStatus();
        }
        
        function testClearAll() {
            log('üîç Limpando todas as notifica√ß√µes...');
            
            const list = document.querySelector('.notification-list');
            if (list) {
                list.innerHTML = `
                    <div class="search-empty">
                        <i class="fas fa-bell-slash" style="font-size: 24px; margin-bottom: 8px; display: block;"></i>
                        Nenhuma notifica√ß√£o
                    </div>
                `;
                
                const badge = document.getElementById('notification-badge');
                if (badge) {
                    badge.classList.add('hidden');
                }
                
                log('‚úÖ Todas as notifica√ß√µes foram limpas', 'success');
            } else {
                log('‚ùå Lista de notifica√ß√µes n√£o encontrada', 'error');
            }
            
            updateStatus();
        }
        
        // Atualizar status a cada segundo
        setInterval(updateStatus, 1000);
        
        // Verificar se a topbar foi criada
        setTimeout(() => {
            const topbar = document.querySelector('.topbar');
            if (topbar) {
                log('‚úÖ Topbar criada com sucesso!', 'success');
                
                // Verificar elementos das notifica√ß√µes
                const notificationIcon = document.querySelector('.notification-icon');
                const notificationDropdown = document.querySelector('.notification-dropdown');
                const notificationBadge = document.getElementById('notification-badge');
                
                if (notificationIcon) {
                    log('‚úÖ √çcone de notifica√ß√µes encontrado', 'success');
                } else {
                    log('‚ùå √çcone de notifica√ß√µes n√£o encontrado', 'error');
                }
                
                if (notificationDropdown) {
                    log('‚úÖ Dropdown de notifica√ß√µes encontrado', 'success');
                } else {
                    log('‚ùå Dropdown de notifica√ß√µes n√£o encontrado', 'error');
                }
                
                if (notificationBadge) {
                    log('‚úÖ Badge de notifica√ß√µes encontrado', 'success');
                } else {
                    log('‚ùå Badge de notifica√ß√µes n√£o encontrado', 'error');
                }
                
                updateStatus();
            } else {
                log('‚ùå Topbar n√£o foi criada', 'error');
            }
        }, 500);
        
        // Expor inst√¢ncia da topbar para testes
        setTimeout(() => {
            if (window.SimpleTopbar) {
                window.topbarInstance = new SimpleTopbar();
                log('‚úÖ Inst√¢ncia da topbar criada para testes', 'success');
            }
        }, 1000);
    </script>
</body>
</html>
